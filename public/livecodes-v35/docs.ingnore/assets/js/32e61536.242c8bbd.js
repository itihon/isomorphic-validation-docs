"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8204],{4887:(e,t,a)=>{a.d(t,{Z:()=>l});var o=a(7294),n=a(1262),s=a(814),r=a(9493),i=a(1446);function l(e){const{params:t,config:a,code:l,language:c="js",codeTitle:d="",showLineNumbers:p=!1,formatCode:h=!0,linkText:m="Run in LiveCodes",style:u={},className:g=""}=e,f=(0,r.r)({appUrl:i.G,params:t,config:a});return o.createElement("div",{style:{marginBottom:"30px",...u},className:g},l&&o.createElement(n.Z,null,(()=>{return o.createElement(s.Z,{language:c,title:d,showLineNumbers:p},h?(e=l,void 0===(t=c)&&(t="js"),window.prettier?.format(e,{parser:"html"===t?"html":"babel",plugins:window.prettierPlugins})):l);var e,t})),o.createElement("a",{href:f,target:"_blank",rel:"noreferrer"},m,o.createElement("svg",{width:"12",height:"12","aria-hidden":"true",viewBox:"0 0 24 24",className:"iconExternalLink_node_modules-@docusaurus-theme-classic-lib-theme-Icon-ExternalLink-styles-module",style:{marginLeft:"4px"}},o.createElement("path",{fill:"currentColor",d:"M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"}))))}},9493:(e,t,a)=>{a.d(t,{T:()=>n,r:()=>s});var o=a(7728);async function n(e,t){void 0===t&&(t={}),"object"!=typeof e||e instanceof HTMLElement||"headless"!==e.view||(t=e,e=null);const{appUrl:a="https://livecodes.io/",params:o={},config:n={},import:s,lite:r,loading:i="lazy",template:l,view:c="split"}=t,d="headless"===c;let p,h=null;if("string"==typeof e)h=document.querySelector(e);else if(e instanceof HTMLElement)h=e;else if(!d||"object"!=typeof e)throw new Error("A valid container element is required.");if(!h){if(!d)throw new Error(`Cannot find element: "${e}"`);h=document.createElement("div"),T(h),document.body.appendChild(h)}try{p=new URL(a)}catch{throw new Error(`"${a}" is not a valid URL.`)}const m=p.origin;if("object"==typeof o&&Object.keys(o).forEach((e=>{p.searchParams.set(e,String(o[e]))})),"string"==typeof n)try{new URL(n),p.searchParams.set("config",n)}catch{throw new Error('"config" is not a valid URL or configuration object.')}else{if("object"!=typeof n)throw new Error('"config" is not a valid URL or configuration object.');Object.keys(n).length>0&&p.searchParams.set("config","sdk")}l&&p.searchParams.set("template",l),s&&p.searchParams.set("x",s),r&&p.searchParams.set("lite","true"),p.searchParams.set("embed","true"),p.searchParams.set("loading",d?"eager":i),p.searchParams.set("view",c);let u=!1;const g="Cannot call API methods after calling `destroy()`.",f=await new Promise((e=>{if(!h)return;const t=h.dataset.height||h.style.height;if(t&&!d){const e=isNaN(Number(t))?t:t+"px";h.style.height=e}"false"===h.dataset.defaultStyles||d||(h.style.backgroundColor||="#fff",h.style.border||="1px solid black",h.style.borderRadius||="5px",h.style.boxSizing||="border-box",h.style.padding||="0",h.style.width||="100%",h.style.height||=h.style.height||"300px",h.style.minHeight="200px",h.style.flexGrow="1",h.style.overflow||="hidden",h.style.resize||="vertical");const a=document.createElement("iframe");a.setAttribute("allow","accelerometer; camera; encrypted-media; display-capture; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; web-share"),a.setAttribute("allowtransparency","true"),a.setAttribute("allowpaymentrequest","true"),a.setAttribute("allowfullscreen","true"),a.setAttribute("sandbox","allow-same-origin allow-downloads allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-presentation allow-scripts");const o="eager"===i?"eager":"lazy";a.setAttribute("loading",o),a.classList.add("livecodes"),d?T(a):(a.style.height="100%",a.style.minHeight="200px",a.style.width="100%",a.style.margin="0",a.style.border="0",a.style.borderRadius=h.style.borderRadius),addEventListener("message",(function e(t){t.source===a.contentWindow&&t.origin===m&&"livecodes-get-config"===t.data?.type&&(removeEventListener("message",e),a.contentWindow?.postMessage({type:"livecodes-config",payload:n},m))})),a.onload=()=>{e(a)},a.src=p.href,h.appendChild(a)})),b=new Promise((e=>{addEventListener("message",(function t(a){a.source===f.contentWindow&&a.origin===m&&"livecodes-ready"===a.data?.type&&(removeEventListener("message",t),e(),b.settled=!0)}))})),w=()=>u?Promise.reject(g):new Promise((async e=>{b.settled&&e();f.contentWindow?.postMessage({type:"livecodes-load"},m),await b,e()})),v=(e,t)=>new Promise((async(a,o)=>{if(u)return o(g);await w();const n=L();addEventListener("message",(function t(s){if(s.source===f.contentWindow&&s.origin===m&&"livecodes-api-response"===s.data?.type&&s.data?.id===n&&s.data.method===e){removeEventListener("message",t);const e=s.data.payload;e?.error?o(e.error):a(e)}})),f.contentWindow?.postMessage({method:e,id:n,args:t},m)})),y={},k=["load","ready","code","console","tests","destroy"],N=(e,t)=>{if(u)throw new Error(g);return k.includes(e)?(v("watch",[e]),y[e]||(y[e]=[]),y[e]?.push(t),{remove:()=>{y[e]=y[e]?.filter((e=>e!==t)),0===y[e]?.length&&v("watch",[e,"unsubscribe"])}}):{remove:()=>{}}};addEventListener("message",(async e=>{const t={"livecodes-app-loaded":"load","livecodes-ready":"ready","livecodes-change":"code","livecodes-console":"console","livecodes-test-results":"tests","livecodes-destroy":"destroy"}[e.data?.type??""];if(e.source!==f.contentWindow||e.origin!==m||!t||!y[t])return;const a=e.data?.payload;y[t]?.forEach((e=>{e(a)}))}));const C=()=>{Object.values(y).forEach((e=>{e.length=0})),f?.remove?.(),u=!0};if("lazy"===i&&"IntersectionObserver"in window){new IntersectionObserver(((e,t)=>{e.forEach((async e=>{e.isIntersecting&&(await w(),t.unobserve(h))}))}),{rootMargin:"150px"}).observe(h)}function T(e){e.style.position="absolute",e.style.top="0",e.style.visibility="hidden",e.style.opacity="0"}const L=()=>(String(Math.random())+Date.now().toFixed()).replace("0.","");return{load:()=>w(),run:()=>v("run"),format:e=>v("format",[e]),getShareUrl:e=>v("getShareUrl",[e]),getConfig:e=>v("getConfig",[e]),setConfig:e=>v("setConfig",[e]),getCode:()=>v("getCode"),show:(e,t)=>v("show",[e,t]),runTests:()=>v("runTests"),onChange:e=>N("code",e),watch:N,exec:function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),o=1;o<t;o++)a[o-1]=arguments[o];return v("exec",[e,...a])},destroy:()=>b.settled?v("destroy").then(C):u?Promise.reject(g):(C(),Promise.resolve())}}function s(e){void 0===e&&(e={});const{appUrl:t,params:a,config:n,import:s,...r}=e,i="string"==typeof n?{config:n}:"object"==typeof n?{x:"code/"+(0,o.compressToEncodedURIComponent)(JSON.stringify(n))}:{},l=new URLSearchParams(JSON.parse(JSON.stringify({...r,...a,x:s,...i}))).toString();return(t||"https://livecodes.io")+(l?"?"+l:"")}globalThis.document&&document.currentScript&&"prefill"in document.currentScript?.dataset&&window.addEventListener("load",(()=>{document.querySelectorAll(".livecodes").forEach((e=>{let t;const a=e.dataset.options;if(a)try{t=JSON.parse(a)}catch{}let o;const s=e.dataset.config||e.dataset.prefill;if(s)try{o=JSON.parse(s)}catch{}const r=encodeURIComponent(e.outerHTML);e.innerHTML="",n(e,{import:"dom/"+r,...t,...o?{config:o}:{}})}))}))},6150:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var o=a(7462),n=(a(7294),a(3905)),s=a(4887);const r={},i="Broadcast",l={unversionedId:"features/broadcast",id:"features/broadcast",title:"Broadcast",description:"Overview",source:"@site/docs/features/broadcast.md",sourceDirName:"features",slug:"/features/broadcast",permalink:"/docs/features/broadcast",draft:!1,editUrl:"https://github.com/live-codes/livecodes/tree/develop/docs/docs/features/broadcast.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Sync",permalink:"/docs/features/sync"},next:{title:"Backup / Restore",permalink:"/docs/features/backup-restore"}},c={},d=[{value:"Overview",id:"overview",level:2},{value:"Technical Details",id:"technical-details",level:2}],p={toc:d};function h(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,o.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"broadcast"},"Broadcast"),(0,n.kt)("h2",{id:"overview"},"Overview"),(0,n.kt)("p",null,"LiveCodes Broadcast allows sending the ",(0,n.kt)("a",{parentName:"p",href:"/docs/features/result"},"result page")," (and optionally source & compiled code and project configuration) to custom API. This can be used to live-view result page updates on different browsers/devices in real-time or broadcast live-coding sessions."),(0,n.kt)("admonition",{type:"note"},(0,n.kt)("p",{parentName:"admonition"},"Broadcast can only be performed from the full app, and not from embedded playgrounds.")),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"Broadcast")," screen can be accessed from the Broadcast icon in the ",(0,n.kt)("a",{parentName:"p",href:"/docs/features/tools-pane"},"tools pane")," (below the result page), or from the app menu \u2192 Broadcast."),(0,n.kt)(s.Z,{params:{screen:"broadcast"},linkText:"direct link",mdxType:"RunInLiveCodes"}),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Broadcast UI",src:a(1149).Z,width:"2681",height:"1286"})),(0,n.kt)("p",null,"On connecting to the server, the channel URL returned by the server is displayed. The channel URL can be shared to different clients (browsers on same or different devices) to view result page or code updates in real-time."),(0,n.kt)("p",null,"If the option ",(0,n.kt)("inlineCode",{parentName:"p"},"Include source code")," is enabled, the source and compiled code together with the current project configuration are also posted to the server with each update."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Broadcast UI - broadcasting",src:a(376).Z,width:"2676",height:"1285"})),(0,n.kt)("p",null,"The Broadcast icon (in tools pane), shows the broadcast status. Clicking the icon, opens the broadcast UI, where the channel URL is displayed and the broadcast can be stopped."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Broadcast icon - broadcasting",src:a(7502).Z,width:"3200",height:"1447"})),(0,n.kt)("admonition",{title:"Server",type:"info"},(0,n.kt)("p",{parentName:"admonition"},"An open-source example implementation of an API server is available on: ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/live-codes/broadcast"},"live-codes/broadcast"),"."),(0,n.kt)("p",{parentName:"admonition"},"It is a ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/live-codes/broadcast/blob/main/index.js"},"simple implementation"),", which you can use or extend. It makes use of LiveCodes ",(0,n.kt)("a",{parentName:"p",href:"/docs/features/embeds"},"Embeds")," and ",(0,n.kt)("a",{parentName:"p",href:"/docs/sdk/"},"SDK")," for code broadcasting."),(0,n.kt)("p",{parentName:"admonition"},"A demo, free-to-test, instance is hosted on:\n",(0,n.kt)("a",{parentName:"p",href:"https://livecodes-broadcast.onrender.com/"},"https://livecodes-broadcast.onrender.com/")," (low resources - sleeps after 15 minutes of inactivity)"),(0,n.kt)("p",{parentName:"admonition"},"You can use one of these links to self-host it:"),(0,n.kt)("a",{href:"https://render.com/deploy?repo=https://github.com/live-codes/broadcast"},(0,n.kt)("img",{src:"https://render.com/images/deploy-to-render-button.svg",alt:"Deploy to Render",width:"150"})),"\xa0\xa0\xa0",(0,n.kt)("a",{href:"https://heroku.com/deploy?template=https://github.com/live-codes/broadcast/tree/main"},(0,n.kt)("img",{src:"https://www.herokucdn.com/deploy/button.svg",alt:"Deploy to Heroku",width:"150"}))),(0,n.kt)("admonition",{title:"Hosted API",type:"tip"},(0,n.kt)("p",{parentName:"admonition"},(0,n.kt)("a",{parentName:"p",href:"/docs/sponsor"},"LiveCodes sponsors")," (bronze sponsors and above) get access to a hosted (always-on) API, which they can use without having to manage their own server.")),(0,n.kt)("p",null,"These are screenshots for the live-updated result page and code:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Broadcasting result",src:a(1653).Z,width:"3200",height:"1435"})),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Broadcasting code",src:a(1723).Z,width:"3200",height:"1441"})),(0,n.kt)("h2",{id:"technical-details"},"Technical Details"),(0,n.kt)("p",null,"When starting a broadcast, the app sends a ",(0,n.kt)("inlineCode",{parentName:"p"},"POST")," request to the specified server with a body that has the following properties:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"result"),": a string with the result page html."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"data")," (Only if ",(0,n.kt)("inlineCode",{parentName:"li"},"Include source code")," option is enabled): an object containing source and compiled code together with the current project configuration."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"userToken")," (Optional): Can be used by the server to authorize users who can broadcast (see below how to set it).")),(0,n.kt)("p",null,"When the server successfully creates a channel, it should respond by sending a JSON object with the following properties:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"channel"),": a string representing the channel Id."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"channelUrl"),": a string with the URL of the channel that can be shared to the clients who want to connect to it."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"channelToken"),": a string representing a secret token for this channel, to prevent others from sending to the same channel. This is only sent once (in response to the request that created the channel).")),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"channel")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"channelToken")," are remembered by the app, and are sent in subsequent requests for the same channel (with every result page update). They are deleted when stopping broadcast or when the app reloads."),(0,n.kt)("admonition",{type:"note"},(0,n.kt)("p",{parentName:"admonition"},"To set a ",(0,n.kt)("inlineCode",{parentName:"p"},"userToken")," for authorization with a broadcast server, run the following in the browser console:"),(0,n.kt)("pre",{parentName:"admonition"},(0,n.kt)("code",{parentName:"pre",className:"language-js"},"await livecodes.exec('setBroadcastToken', 'my-token');\n")),(0,n.kt)("p",{parentName:"admonition"},"The supplied value (in this case ",(0,n.kt)("inlineCode",{parentName:"p"},"my-token"),") will be posted to the server with every update as the value for the property ",(0,n.kt)("inlineCode",{parentName:"p"},"userToken"),"."),(0,n.kt)("p",{parentName:"admonition"},"This value is saved for the current user across app reloads.")))}h.isMDXComponent=!0},1149:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/broadcast-f2bf3925c639a968954f34474e06c987.jpg"},1723:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/broadcasting-code-04761ce405a36b7a63470f2b674b7091.jpg"},1653:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/broadcasting-result-fd66611a7732b156f76120ab321a39d0.jpg"},376:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/broadcasting-72c21fde1810aa2448f0e39444484a5f.jpg"},7502:(e,t,a)=>{a.d(t,{Z:()=>o});const o=a.p+"assets/images/broadcasting2-43b4c3f983230bb8ca36e3eed42b020f.jpg"}}]);